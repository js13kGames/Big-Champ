var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.arrayFromIterator=function(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c};
$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(a){var b=function(){};b.prototype=a;return new b};$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},b={};try{return b.__proto__=a,b.a}catch(c){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null;
$jscomp.inherits=function(a,b){a.prototype=$jscomp.objectCreate(b.prototype);a.prototype.constructor=a;if($jscomp.setPrototypeOf){var c=$jscomp.setPrototypeOf;c(a,b)}else for(c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.superClass_=b.prototype};
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var f=a[d];f in c||(c[f]={});c=c[f]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(a,c,d){var b=this.length||0;0>c&&(c=Math.max(0,b+c));if(null==d||d>b)d=b;d=Number(d);0>d&&(d=Math.max(0,b+d));for(c=Number(c||0);c<d;c++)this[c]=a;return this}},"es6","es3");
gameWidth=800;gameHeight=450;gameScale=1;Deg2Rad=Math.PI/180;Rad2Deg=180/Math.PI;canvas=document.createElement("canvas");canvas.setAttribute("width",gameWidth);canvas.setAttribute("height",gameHeight);canvas.style.width=gameWidth*gameScale+"px";canvas.style.height=gameHeight*gameScale+"px";document.getElementById("game").appendChild(canvas);ctx=this.canvas.getContext("2d");ctx.imageSmoothingEnabled=!1;touch={x:0,y:0,up:!1,down:!1,held:!1};
canvas.addEventListener("mousedown",function(a){touch.up=!1;touch.down=!0;touch.held=!0;CreateAudioContext()},!1);canvas.addEventListener("mouseup",function(a){touch.up=!0;touch.down=!1;touch.held=!1},!1);canvas.addEventListener("mousemove",function(a){SetTouchPos(a);a.preventDefault()},!1);canvas.addEventListener("touchstart",function(a){SetTouchPos(a.touches[0]);touch.up=!1;touch.down=!0;touch.held=!0;a.preventDefault();CreateAudioContext()},!1);
canvas.addEventListener("touchend",function(a){touch.up=!0;touch.down=!1;touch.held=!1;a.preventDefault()},!1);canvas.addEventListener("touchcancel",function(a){touch.up=!0;touch.down=!1;touch.held=!1;a.preventDefault()},!1);canvas.addEventListener("touchmove",function(a){SetTouchPos(a.touches[0]);a.preventDefault()},!1);SetTouchPos=function(a){touch.x=(a.pageX-canvas.offsetLeft)/gameScale;touch.y=(a.pageY-canvas.offsetTop)/gameScale};
PushMatrix=function(a,b,c){c=void 0===c?0:c;ctx.save();ctx.translate(a,b);ctx.rotate(c*Deg2Rad)};PopMatrix=function(){ctx.restore()};LoadSprite=function(a){sprite=new Image;sprite.src=a;return sprite};DrawLine=function(a,b,c,d,f,e){e=void 0===e?1:e;ctx.save();ctx.strokeStyle=f;ctx.lineWidth=e;ctx.lineCap="round";ctx.beginPath();ctx.moveTo(a,b);ctx.lineTo(c,d);ctx.stroke();ctx.restore()};
DrawBezierLine=function(a,b,c,d,f,e,l,p,n,q){ctx.save();ctx.strokeStyle=n;ctx.lineWidth=q;ctx.lineCap="round";ctx.beginPath();ctx.moveTo(a,b);ctx.bezierCurveTo(f,e,l,p,c,d);ctx.stroke();ctx.restore()};DrawRect=function(a,b,c,d,f,e){e=void 0===e?0:e;c*=.5;d*=.5;ctx.save();ctx.translate(a+.5,b+.5);ctx.rotate(e*Deg2Rad);ctx.fillStyle=f;ctx.beginPath();ctx.moveTo(-c,-d);ctx.lineTo(c,-d);ctx.lineTo(c,d);ctx.lineTo(-c,d);ctx.lineTo(-c,-d);ctx.fill();ctx.restore()};
DrawCircle=function(a,b,c,d,f,e){f=void 0===f?0:f;e=void 0===e?2*Math.PI:e;ctx.save();ctx.translate(a+.5,b+.5);ctx.fillStyle=d;ctx.beginPath();ctx.arc(a,b,c,f,e);ctx.fill();ctx.restore()};DrawSprite=function(a,b,c,d,f,e){e=void 0===e?0:e;d=a.width*(void 0===d?1:d);f=a.height*(void 0===f?1:f);ctx.save();ctx.translate(b,c);ctx.rotate(e*Deg2Rad);ctx.drawImage(a,.5*-d,.5*-f,d,f);ctx.restore()};
DrawText=function(a,b,c,d,f,e,l,p,n,q,r){d=void 0===d?12:d;f=void 0===f?"#FFF":f;e=void 0===e?0:e;l=void 0===l?"Arial":l;p=void 0===p?"":p;n=void 0===n?"left":n;q=void 0===q?"bottom":q;r=void 0===r?0:r;ctx.save();ctx.translate(b,c);ctx.rotate(e*Deg2Rad);ctx.font=p+" "+d+"px "+l;ctx.fillStyle=f;ctx.textAlign=n;ctx.textBaseline=q;0<r&&(ctx.strokeStyle="#000",ctx.lineWidth=r,ctx.lineJoin="round",ctx.strokeText(a,0,0));ctx.fillText(a,0,0);ctx.restore()};zzfxV=.3;
zzfx=function(a,b,c,d,f,e,l,p,n,q,r,N,C,x,D,O,R,A,S,h,u,E,F,y,t,m,G,v,P,H,Q,I,J,g,K,L,k,w,B,z,M){a=void 0===a?1:a;b=void 0===b?.05:b;c=void 0===c?220:c;l=void 0===l?0:l;p=void 0===p?1:p;n=void 0===n?0:n;q=void 0===q?0:q;r=void 0===r?0:r;N=void 0===N?0:N;C=void 0===C?0:C;x=void 0===x?0:x;D=void 0===D?0:D;O=void 0===O?0:O;A=void 0===A?1:A;h=void 0===h?44100:h;u=void 0===u?99+(void 0===d?0:d)*h:u;E=void 0===E?(void 0===f?0:f)*h:E;F=void 0===F?(void 0===e?.1:e)*h:F;y=void 0===y?(void 0===S?0:S)*h:y;t=
void 0===t?(void 0===R?0:R)*h:t;m=void 0===m?2*Math.PI:m;G=void 0===G?function(a){return 0<a?1:-1}:G;v=void 0===v?u+y+E+F+t:v;P=void 0===P?n*=500*m/Math.pow(h,2):P;H=void 0===H?c*=(1+2*b*Math.random()-b)*m/h:H;Q=void 0===Q?G(D)*m/4:Q;I=void 0===I?0:I;J=void 0===J?0:J;g=void 0===g?0:g;K=void 0===K?0:K;L=void 0===L?0:L;k=void 0===k?0:k;w=void 0===w?1:w;B=void 0===B?[]:B;z=void 0===z?zzfxX.createBufferSource():z;M=void 0===M?zzfxX.createBuffer(1,v,h):M;for(z.connect(zzfxX.destination);g<v;B[g++]=k)++L>
100*O&&(L=0,k=I*c*Math.sin(J*D*m/h-Q),k=G(k=l?1<l?2<l?3<l?Math.sin(Math.pow(k%m,3)):Math.max(Math.min(Math.tan(k),1),-1):1-(2*k/m%2+2)%2:1-4*Math.abs(Math.round(k/m)-k/m):Math.sin(k))*Math.pow(Math.abs(k),p)*a*zzfxV*(g<u?g/u:g<u+y?1-(g-u)/y*(1-A):g<u+y+E?A:g<v-t?(v-g-t)/F*A:0),k=t?k/2+(t>g?0:(g<v-t?1:(g-v)/t)*B[g-t|0]/2):k),I+=1-x+1E9*(Math.sin(g)+1)%2*x,J+=1-x+1E9*(Math.pow(Math.sin(g),2)+1)%2*x,c+=n+=500*q*m/Math.pow(h,3),w&&++w>N*h&&(c+=r*m/h,H+=r*m/h,w=0),C&&++K>C*h&&(c=H,n=P,K=1,w=w||1);return M.getChannelData(0).set(B),
z.buffer=M,z.start(),z};zzfxX=void 0;CreateAudioContext=function(){void 0==zzfxX&&(zzfxX=new AudioContext)};var V2=function(a,b){this.x=void 0!=a?a:0;this.y=void 0!=b?b:0};V2.prototype.Set=function(a,b){this.x=a;this.y=b};V2.prototype.SetV=function(a){this.x=a.x;this.y=a.y};V2.prototype.SetToFrom=function(a,b){this.x=b.x-a.x;this.y=b.y-a.y};V2.prototype.AddV=function(a){this.x+=a.x;this.y+=a.y};V2.prototype.SubV=function(a){this.x-=a.x;this.y-=a.y};
V2.prototype.MulS=function(a){this.x*=a;this.y*=a};V2.prototype.DivS=function(a){this.x/=a;this.y/=a};V2.prototype.DistTo=function(a){return Math.sqrt(this.DistToSq(a))};V2.prototype.DistToSq=function(a){var b=this.x-a.x;a=this.y-a.y;return b*b+a*a};V2.prototype.Len=function(){return Math.sqrt(this.LenSq())};V2.prototype.LenSq=function(){return this.x*this.x+this.y*this.y};V2.prototype.Normalize=function(){var a=this.Len();this.x/=a;this.y/=a};
V2.prototype.ClampMax=function(a){var b=this.LenSq();b>a*a&&(b=Math.sqrt(b),this.x=this.x/b*a,this.y=this.y/b*a)};nextState=state=null;Enter=0;Tick=1;Draw=2;Exit=3;clearColor="#1A1A1AFF";gameLoopFixedTimeStep=1/60;gameLoopFrameTimeAccum=0;previousGameLoopTime=void 0;
GameLoop=function(a){window.requestAnimationFrame(GameLoop);for(gameLoopFrameTimeAccum+=Math.min((a-(previousGameLoopTime||a))/1E3,.2);gameLoopFrameTimeAccum>gameLoopFixedTimeStep;)gameLoopFrameTimeAccum-=gameLoopFixedTimeStep,null!=nextState&&(null!=state&&state(Exit),state=nextState,nextState=null,null!=state&&state(Enter)),state&&state(Tick);ctx.rect(0,0,gameWidth,gameHeight);ctx.fillStyle=clearColor;ctx.fill();state&&state(Draw);touch.up=!1;touch.down=!1;previousGameLoopTime=a};window.requestAnimationFrame(GameLoop);
enemyFuncs=[];enemyFuncs.push({prob:1,func:function(){objs.push(new Enemy_SlowRun)}});enemyFuncs.push({prob:1,func:function(){objs.push(new Enemy_FastRun)}});enemyFuncs.push({prob:1,func:function(){objs.push(new Enemy_SlowBounce)}});enemyFuncs.push({prob:1,func:function(){objs.push(new Enemy_DelayedAttack)}});enemyFuncs.push({prob:1,func:function(){objs.push(new Enemy_LongJump)}});var enemyFuncsTotalProb=0;enemyFuncs.forEach(function(a){return enemyFuncsTotalProb+=a.prob});
CreateEnemy=function(){for(var a=0,b=Math.random(),c=0;c<enemyFuncs.length;++c)if(a+=enemyFuncs[c].prob/enemyFuncsTotalProb,b<=a){enemyFuncs[c].func();zzfx.apply(null,[,,521,.02,,.09,,2.24,-11,-39,-961,.15,,.1,,,.01,,.03]);break}};crowd=[];crowdColors="#331C16 #400101 #2A110A #28251E #152833 #333015 #06280D".split(" ");for(var i=0;300>i;++i)crowd.push({x:Math.random()*gameWidth,y:Math.random()*gameHeight*.5,col:Math.floor(Math.random()*crowdColors.length),off:Math.random(),spd:.003*Math.random()});
flashes=[];nextFlashTime=Math.floor(100*Math.random());
DrawCrowd=function(){crowd.forEach(function(a){DrawRect(a.x,a.y+Math.abs(3*Math.sin(Date.now()*(.001+a.spd)+a.off)),10,10,crowdColors[a.col])});for(var a=0;a<flashes.length;++a){var b=flashes[a],c="F";2>b.t?c="4":5>b.t?c="8":10>b.t&&(c="A");DrawRect(b.x,b.y,25,25,"#FFF"+c);b.t--;0>=b.t&&flashes.splice(a,1)}nextFlashTime--;0>=nextFlashTime&&(nextFlashTime=Math.floor(50*Math.random()),flashes.push({x:Math.random()*gameWidth,y:Math.random()*gameHeight*.3,t:15}))};
DrawBackground=function(){DrawCrowd();DrawRect(.5*gameWidth,.5*gameHeight,gameWidth,100,"#383838");PushMatrix(0,.25*-player.bellyOffset.y,0);DrawLine(100,280,810,280,"#3A50BD",15);DrawLine(100,280,-10,460,"#3A50BD",13.5);DrawLine(100,240,810,240,"#EDF7F7",15);DrawLine(100,240,-10,405,"#EDF7F7",13.5);DrawLine(100,200,810,200,"#CE3B2F",15);DrawLine(100,200,-10,355,"#CE3B2F",13.5);DrawLine(110,190,110,315,"#111",30);ctx.beginPath();ctx.moveTo(95,315);ctx.lineTo(15,460);ctx.lineTo(810,460);ctx.lineTo(810,
315);ctx.closePath();ctx.fillStyle="#83839E";ctx.fill();ctx.beginPath();ctx.moveTo(100,320);ctx.lineTo(25,460);ctx.lineTo(810,460);ctx.lineTo(810,320);ctx.closePath();ctx.fillStyle="#BFBEE5";ctx.fill();PopMatrix()};DrawHud=function(){for(var a=0;3>a;++a)DrawRect(40+40*a,40,28,28,"#000"),DrawRect(40+40*a,40,20,20,player.health>a?"#F00":"#444");DrawText(player.score.toString(),gameWidth-40,50,40,"#FFF",0,"Arial","Bold","right","center",8)};
var PlayerStateIdle=0,PlayerStateBelly=1,PlayerStateHit=2,PlayerStateDead=3,BellyBounceTime=45,BellyBounceAttackTime=8,PlayerHitTime=20,Player=function(){this.Reset()};Player.prototype.Reset=function(){this.Idle();this.health=3;this.score=0;this.bellyOffset=new V2(0,0);this.bellyOffset.xLast=0;this.bellyOffset.yLast=0};
Player.prototype.Tick=function(){switch(this.state){case PlayerStateIdle:touch.down&&state!=RenderTest&&this.BellyBounce();break;case PlayerStateBelly:this.timer--;0==this.timer&&this.Idle();touch.down&&this.hitConfirm&&this.BellyBounce();break;case PlayerStateHit:this.timer--,0==this.timer&&(0==this.health?(this.bellyOffset.x=10,this.bellyOffset.y=10,nextState=GameOver,this.state=PlayerStateDead,zzfx.apply(null,[,,56,,.08,.46,3,2.52,,,,,,1.7,.7,.1,,.62,.01])):this.Idle())}this.UpdateBellyPhysics()};
Player.prototype.Idle=function(){this.pos=new V2(200,280);this.timer=this.angle=0;this.hitConfirm=!1;this.state=PlayerStateIdle};Player.prototype.BellyBounce=function(){this.bellyOffset.x=15;this.bellyOffset.y=15;this.timer=BellyBounceTime;this.state=PlayerStateBelly;zzfx.apply(null,[,,596,.05,,.09,1,.18,,-2.7,-4,.17,.11,,-2.1,,.1,,.02])};Player.prototype.IsBellyBounceAttacking=function(){return this.state==PlayerStateBelly&&this.timer>=BellyBounceTime-BellyBounceAttackTime};
Player.prototype.OnBounce=function(a){this.timer=15;this.hitConfirm=!0;this.score++;zzfx.apply(null,[,,235,,,.12,,.15,-4.2,-6.7,,,,1.4,,.1,,.85,.04])};Player.prototype.OnHit=function(a){0<this.health&&(this.health--,this.timer=PlayerHitTime,this.state=PlayerStateHit,this.bellyOffset.x=5,this.bellyOffset.y=5,zzfx.apply(null,[,,272,,,.16,3,2.99,-1.7,1.6,,,,1.4,-.7,.2,,.68,.03]))};
Player.prototype.UpdateBellyPhysics=function(){var a=this.bellyOffset.x-this.bellyOffset.xLast,b=this.bellyOffset.y-this.bellyOffset.yLast;this.bellyOffset.xLast=this.bellyOffset.x;this.bellyOffset.yLast=this.bellyOffset.y;this.bellyOffset.x+=a;this.bellyOffset.y+=b;a=this.bellyOffset.Len();0<a&&(a=(a-0)/a,a=new V2(this.bellyOffset.x*a*.2,this.bellyOffset.y*a*.2),this.bellyOffset.SubV(a))};
Player.prototype.Draw=function(){PushMatrix(this.pos.x,this.pos.y,this.angle);this.skinColor="#DC774F";this.outlineColor="#A3583A";this.outfitColor=this.bootColor="#111";this.eyeColor="#FFF";this.pupilColor="#000";this.mouthColor="#500";this.lacesColor="#FFF";switch(this.state){case PlayerStateIdle:this.DrawLeg(66,24,0);this.DrawBody(0,0,0);this.DrawHead(-10,-90,0);this.DrawOutfit(0,0,0);this.DrawLeg(-20,24,0);this.DrawArm(-68,-20,0);break;case PlayerStateBelly:this.DrawLeg(90,35,30);this.DrawBody(40,
-20,-15);this.DrawHead(-5,-100,-40);this.DrawOutfit(40,-20,-15);this.DrawLeg(25,35,30);this.DrawArm(-30,-22,10);break;case PlayerStateHit:this.DrawLeg(26,14,-30);this.DrawBody(-20,5,0);this.DrawHead(-10,-80,20);this.DrawOutfit(-20,5,0);this.DrawLeg(-50,24,-35);this.DrawArm(-88,-15,-50);break;case PlayerStateDead:this.DrawLeg(-6,24,-60),this.DrawBody(-40,15,0),this.DrawHead(-20,-60,40+5*Math.sin(.001*Date.now())),this.DrawOutfit(-40,15,0),this.DrawLeg(-80,42,-60),this.DrawArm(-108,-5,-20)}PopMatrix()};
Player.prototype.DrawLeg=function(a,b,c){PushMatrix(a+.5*this.bellyOffset.x,b+.5*this.bellyOffset.y,c);DrawCircle(-10,8,20,this.skinColor);DrawRect(-20,46,40,60,this.skinColor);DrawRect(-20,56,42,42,this.bootColor);DrawRect(-10,45,14,4,this.lacesColor);DrawRect(-10,55,14,4,this.lacesColor);DrawRect(-10,65,14,4,this.lacesColor);PopMatrix()};
Player.prototype.DrawBody=function(a,b,c){PushMatrix(a+this.bellyOffset.x,b+this.bellyOffset.y,c);DrawCircle(0,0,80+1*this.bellyOffset.x,this.skinColor,Math.PI,2*Math.PI);DrawCircle(24,-10,6,this.outlineColor);DrawCircle(-4,-10,6,this.outlineColor);PopMatrix()};
Player.prototype.DrawOutfit=function(a,b,c){PushMatrix(a+this.bellyOffset.x,b+this.bellyOffset.y,c);DrawBezierLine(-46,-58,-20,20,-10,-20,-10,20,this.outfitColor,20);DrawCircle(-32,-9,28,this.outlineColor);DrawCircle(0,0,80+1*this.bellyOffset.x,this.outfitColor,0,Math.PI);PopMatrix()};Player.prototype.DrawArm=function(a,b,c){PushMatrix(a+.5*this.bellyOffset.x,b+.5*this.bellyOffset.y,c);DrawCircle(0,0,28,this.skinColor);DrawCircle(-6,16,20,this.skinColor);PopMatrix()};
Player.prototype.DrawHead=function(a,b,c){PushMatrix(a+.5*this.bellyOffset.x,b+.5*this.bellyOffset.y,c);DrawRect(0,0,70,70,this.skinColor);switch(this.state){case PlayerStateIdle:DrawRect(4,0,12,20,this.eyeColor);DrawRect(22,0,12,20,this.eyeColor);DrawRect(6,4,8,12,this.pupilColor);DrawRect(24,4,8,12,this.pupilColor);DrawRect(10,20,40,4,this.mouthColor);break;case PlayerStateBelly:DrawRect(4,0,12,20,this.eyeColor);DrawRect(22,0,12,20,this.eyeColor);DrawRect(5,4,10,12,this.pupilColor);DrawRect(23,
4,10,12,this.pupilColor);DrawRect(10,20,40,10,this.mouthColor);break;case PlayerStateHit:DrawRect(4,0,12,20,this.eyeColor);DrawRect(22,0,12,20,this.eyeColor);DrawRect(0,4,10,12,this.pupilColor);DrawRect(28,-3,10,12,this.pupilColor);DrawRect(10,20,40,10,this.mouthColor);break;case PlayerStateDead:DrawRect(4,0,4,20,this.pupilColor,45),DrawRect(4,0,4,20,this.pupilColor,-45),DrawRect(22,0,4,20,this.pupilColor,45),DrawRect(22,0,4,20,this.pupilColor,-45),DrawRect(10,20,40,10,this.mouthColor)}PopMatrix()};
var EnemyStateMoveToPlayer=0,EnemyStateBounceOff=1,EnemyStyleLowerShorts=0,EnemyStyleLowerPants=1,EnemyStyleUpperNone=0,EnemyStyleUpperTankTop=1,EnemyStyleHeadBald=0,EnemyStyleHeadShortHair=1,EnemyStyleHeadLongHair=2,EnemyStyleHeadMask=3,EnemyFrameIdle=0,EnemyFrameRun01=1,EnemyFrameRun02=2,EnemyFrameRun03=3,EnemyFrameBounceOff=4,EnemyFrameSpin=5,EnemyFrameJump=6,EnemyAnimIdle={frames:[EnemyFrameIdle],counts:[1]},EnemyAnimRun={frames:[EnemyFrameRun01,EnemyFrameRun02,EnemyFrameRun03,EnemyFrameRun02],
counts:[9,9,9,9]},EnemyAnimBounceOff={frames:[EnemyFrameBounceOff],counts:[1]},EnemyAnimSpin={frames:[EnemyFrameSpin],counts:[1]},EnemyAnimJump={frames:[EnemyFrameJump],counts:[1]},Enemy=function(){this.pos=new V2(840,310);this.vel=new V2(0,0);this.state=EnemyStateMoveToPlayer;this.angle=0;this.color="000";this.bounceThreshold=player.pos.x+80;this.damageThreshold=player.pos.x+10;this.bounceOffAngleAdj=0;this.styleLower=EnemyStyleLowerShorts;this.styleUpper=EnemyStyleUpperTankTop;this.styleHead=EnemyStyleHeadMask;
this.skinColor="#DC774F";this.outlineColor="#A3583A";this.bootColor=this.outfitColor="#B00";this.lacesColor="#FFF";this.eyeColor="#000";this.hairColor="#663508";this.maskColor1="#B00";this.maskColor2="#FFF";this.chairColor="#666";this.frame=EnemyFrameIdle;this.SetAnim(EnemyAnimRun)};
Enemy.prototype.Tick=function(){switch(this.state){case EnemyStateMoveToPlayer:this.MoveToPlayer();this.pos.x<=this.bounceThreshold&&player.IsBellyBounceAttacking()?this.BounceOff():this.pos.x<=this.damageThreshold&&!player.IsBellyBounceAttacking()&&(player.OnHit(this),this.KillSelf());break;case EnemyStateBounceOff:this.pos.AddV(this.vel),this.vel.y+=.8,this.angle+=this.bounceOffAngleAdj,this.pos.y>gameHeight&&this.KillSelf()}this.Animate()};
Enemy.prototype.Animate=function(){this.curAnimFrameCount++;this.curAnimFrameCount>=this.anim.counts[this.curAnimFrame]&&(this.curAnimFrameCount=0,this.curAnimFrame++,this.curAnimFrame>=this.anim.frames.length&&(this.curAnimFrame=0));this.frame=this.anim.frames[this.curAnimFrame]};Enemy.prototype.SetAnim=function(a){this.anim=a;this.curAnimFrame=this.curAnimFrameCount=0};Enemy.prototype.MoveToPlayer=function(){this.pos.AddV(this.vel)};
Enemy.prototype.BounceOff=function(){this.vel.Set(7+5*Math.random(),-11-4*Math.random());this.bounceOffAngleAdj=4+5*Math.random();.4>Math.random()&&(this.vel.x=-this.vel.x,this.vel.y*=1.5,this.bounceOffAngleAdj=-this.bounceOffAngleAdj);this.state=EnemyStateBounceOff;this.SetAnim(EnemyAnimBounceOff);player.OnBounce(this)};Enemy.prototype.KillSelf=function(){var a=objs.indexOf(this);-1<a&&objs.splice(a,1)};
Enemy.prototype.Draw=function(){PushMatrix(this.pos.x,this.pos.y,this.angle);switch(this.frame){case EnemyFrameIdle:this.DrawLeg(-23,43,0);this.DrawBody(0,0,0);this.DrawHead(-10,-60,0);this.DrawOutfit(0,0,0);this.DrawLeg(27,43,0);this.DrawArm(20,-15,0);break;case EnemyFrameRun01:PushMatrix(0,0,-5);this.DrawLeg(-23,43,20);this.DrawArm(-30,-25,-55);this.DrawBody(0,0,0);this.DrawHead(-10,-60,0);this.DrawOutfit(0,0,0);this.DrawLeg(10,43,-40);this.DrawArm(20,-25,55);PopMatrix();break;case EnemyFrameRun02:PushMatrix(0,
-15,-5);this.DrawLeg(-23,43,0);this.DrawArm(-30,-25,0);this.DrawBody(0,0,0);this.DrawHead(-10,-60,0);this.DrawOutfit(0,0,0);this.DrawLeg(10,43,0);this.DrawArm(20,-25,0);PopMatrix();break;case EnemyFrameRun03:PushMatrix(0,0,-5);this.DrawLeg(-23,43,-20);this.DrawArm(-30,-25,55);this.DrawBody(0,0,0);this.DrawHead(-10,-60,0);this.DrawOutfit(0,0,0);this.DrawLeg(10,43,40);this.DrawArm(20,-25,-55);PopMatrix();break;case EnemyFrameBounceOff:PushMatrix(0,0,-5);this.DrawLeg(-23,43,70);this.DrawArm(-30,-25,
120);this.DrawBody(0,0,0);this.DrawHead(-10,-60,0);this.DrawOutfit(0,0,0);this.DrawLeg(10,43,-70);this.DrawArm(20,-25,-120);PopMatrix();break;case EnemyFrameSpin:PushMatrix(0,0,-5);this.DrawLeg(-23,33,120);this.DrawArm(-30,-25,45);this.DrawBody(0,0,0);this.DrawHead(-15,-55,-20);this.DrawOutfit(0,0,0);this.DrawLeg(10,33,120);this.DrawArm(20,-25,45);PopMatrix();break;case EnemyFrameJump:PushMatrix(0,0,-5),this.DrawLeg(-23,33,30),this.DrawArm(-30,-25,110),this.DrawBody(0,0,0),this.DrawHead(-10,-60,5),
this.DrawOutfit(0,0,0),this.DrawLeg(10,33,-30),this.DrawArm(20,-25,45),this.DrawChair(-80,-60,0),PopMatrix()}PopMatrix()};Enemy.prototype.DrawBody=function(a,b,c){PushMatrix(a,b,c);DrawRect(-5,0,60,80,this.skinColor);PopMatrix()};
Enemy.prototype.DrawOutfit=function(a,b,c){PushMatrix(a,b,c);switch(this.styleLower){case EnemyStyleLowerShorts:case EnemyStyleLowerPants:DrawRect(-5,35,60,30,this.outfitColor)}switch(this.styleUpper){case EnemyStyleUpperTankTop:DrawRect(-5,0,60,40,this.outfitColor),DrawRect(-25,-20,10,40,this.outfitColor),DrawRect(0,-20,10,40,this.outfitColor)}PopMatrix()};
Enemy.prototype.DrawLeg=function(a,b,c){PushMatrix(a,b,c);a=this.skinColor;switch(this.styleLower){case EnemyStyleLowerPants:a=this.outfitColor}DrawCircle(0,0,13,a);DrawRect(0,15,26,30,a);DrawRect(0,25,26,25,this.bootColor);DrawRect(-5,20,10,4,this.lacesColor);DrawRect(-5,27,10,4,this.lacesColor);PopMatrix()};
Enemy.prototype.DrawHead=function(a,b,c){PushMatrix(a,b,c);DrawRect(0,0,50,50,this.styleHead==EnemyStyleHeadMask?this.maskColor1:this.skinColor);switch(this.styleHead){case EnemyStyleHeadShortHair:DrawRect(0,-20,50,10,this.hairColor);DrawRect(20,-15,10,20,this.hairColor);break;case EnemyStyleHeadLongHair:DrawRect(0,-20,50,10,this.hairColor);DrawRect(20,-15,10,20,this.hairColor);DrawRect(30,-5,10,20,this.hairColor);DrawRect(38,-5,10,25,this.hairColor);break;case EnemyStyleHeadMask:DrawRect(-3,0,32,
20,this.maskColor2)}DrawRect(-12,0,9,15,this.eyeColor);DrawRect(5,0,9,15,this.eyeColor);PopMatrix()};Enemy.prototype.DrawArm=function(a,b,c){PushMatrix(a,b,c);DrawCircle(-1.5,1.5,19,this.outlineColor);DrawCircle(-1.5,13.5,12,this.outlineColor);DrawCircle(0,0,19,this.skinColor);DrawCircle(0,12,12,this.skinColor);PopMatrix()};
Enemy.prototype.DrawChair=function(a,b,c){PushMatrix(a,b,c);DrawRect(0,0,60,35,this.chairColor);DrawRect(0,-40,60,20,this.chairColor);DrawRect(-25,0,10,75,this.chairColor);DrawRect(25,0,10,75,this.chairColor);PopMatrix()};
var Enemy_SlowRun=function(){Enemy.call(this);this.vel.Set(-12,0);this.styleLower=EnemyStyleLowerShorts;this.styleUpper=EnemyStyleUpperNone;this.styleHead=EnemyStyleHeadShortHair;this.skinColor="#DC774F";this.outlineColor="#A3583A";this.bootColor=this.outfitColor="#B00";this.lacesColor="#FFF";this.eyeColor="#000";this.hairColor="#663508";this.SetAnim(EnemyAnimRun)};$jscomp.inherits(Enemy_SlowRun,Enemy);
var Enemy_FastRun=function(){Enemy.call(this);this.vel.Set(-18,0);this.styleLower=EnemyStyleLowerPants;this.styleUpper=EnemyStyleUpperTankTop;this.styleHead=EnemyStyleHeadBald;this.skinColor="#D8A79E";this.outlineColor="#AA8077";this.bootColor=this.outfitColor="#025930";this.lacesColor="#FFF";this.eyeColor="#000";this.hairColor="#663508";this.SetAnim(EnemyAnimRun)};$jscomp.inherits(Enemy_FastRun,Enemy);
var Enemy_SlowBounce=function(){Enemy.call(this);this.color="#00F";this.pos.Set(this.pos.x+140,this.pos.y);this.vel.Set(-10,-16);this.styleLower=EnemyStyleLowerShorts;this.styleUpper=EnemyStyleUpperNone;this.styleHead=EnemyStyleHeadMask;this.skinColor="#CF7B41";this.outlineColor="#87502B";this.bootColor=this.outfitColor="#CCC";this.eyeColor=this.lacesColor="#000";this.maskColor1="#CCC";this.maskColor2="#BB0";this.SetAnim(EnemyAnimSpin);this.isBouncing=!0};$jscomp.inherits(Enemy_SlowBounce,Enemy);
Enemy_SlowBounce.prototype.MoveToPlayer=function(){this.vel.y+=.8;Enemy.prototype.MoveToPlayer.call(this);296<=this.pos.y&&(this.pos.y=296,this.vel.y=-16,this.pos.x<gameWidth&&(this.isBouncing=!1,this.SetAnim(EnemyAnimJump),this.angle=-30));this.isBouncing&&(this.angle-=10)};
var Enemy_DelayedAttack=function(){Enemy.call(this);this.vel.Set(-12,0);this.subTimer=this.subState=0;this.styleLower=EnemyStyleLowerShorts;this.styleUpper=EnemyStyleUpperTankTop;this.styleHead=EnemyStyleHeadLongHair;this.skinColor="#A86741";this.outlineColor="#6D432A";this.bootColor=this.outfitColor="#00B";this.lacesColor="#FFF";this.eyeColor="#000";this.hairColor="#111";this.SetAnim(EnemyAnimRun)};$jscomp.inherits(Enemy_DelayedAttack,Enemy);
Enemy_DelayedAttack.prototype.MoveToPlayer=function(){Enemy.prototype.MoveToPlayer.call(this);switch(this.subState){case 0:640>=this.pos.x&&(this.pos.x=640,this.vel.x=0,this.subState=1,this.subTimer=40);break;case 1:0==Math.floor(this.subTimer/10)%2?(this.pos.Set(640,296),this.angle=0):(this.pos.Set(640,284),this.angle=20<this.subTimer?-15:15),this.subTimer--,0==this.subTimer&&(this.subState=2,this.pos.y=296,this.vel.x=-20)}};
var Enemy_LongJump=function(){Enemy.call(this);this.color="#FF0";this.pos.Set(this.pos.x+80,this.pos.y);this.vel.Set(-20,-20);this.angle=-10;this.styleLower=EnemyStyleLowerShorts;this.styleUpper=EnemyStyleUpperTankTop;this.styleHead=EnemyStyleHeadMask;this.skinColor="#C17920";this.outlineColor="#935C19";this.bootColor=this.outfitColor="#6D59C8";this.lacesColor="#FFF";this.eyeColor="#000";this.hairColor="#663508";this.maskColor1="#6D59C8";this.maskColor2="#FFF";this.SetAnim(EnemyAnimSpin)};
$jscomp.inherits(Enemy_LongJump,Enemy);Enemy_LongJump.prototype.MoveToPlayer=function(){this.vel.y+=1;Enemy.prototype.MoveToPlayer.call(this);296<=this.pos.y&&(this.pos.y=296,this.vel.y=-18);this.angle-=10};var player=new Player,objs=[];objs.push(player);var enemyTimer,touchDelay;
MainMenu=function(a){switch(a){case Tick:touch.down&&(nextState=GameState);break;case Draw:DrawBackground(),objs.forEach(function(a){return a.Draw()}),DrawText("Menu",.5*gameWidth,.3*gameHeight,72,"#FFF",0,"Arial","Bold","center","center",12)}};GameState=function(a){switch(a){case Enter:player.Reset();enemyTimer=setInterval(function(){return CreateEnemy()},1500);break;case Tick:objs.forEach(function(a){return a.Tick()});break;case Draw:DrawBackground(),objs.forEach(function(a){return a.Draw()}),DrawHud()}};
GameOver=function(a){switch(a){case Enter:touchDelay=60;clearInterval(enemyTimer);break;case Tick:touchDelay--;0>touchDelay&&touch.down&&(nextState=MainMenu);objs.forEach(function(a){return a.Tick()});break;case Draw:DrawBackground(),objs.forEach(function(a){return a.Draw()}),DrawHud(),DrawText("Game Over",.5*gameWidth,.3*gameHeight,72,"#FFF",0,"Arial","Bold","center","center",12)}};
RenderTest=function(a){switch(a){case Enter:player.Reset();CreateEnemy();objs[1].pos.x=600;objs[1].pos.y=300;objs[1].SetAnim(EnemyAnimJump);break;case Tick:player.Tick();touch.down&&(player.state++,player.state>PlayerStateDead&&(player.state=PlayerStateIdle));objs[1].Animate();break;case Draw:DrawBackground(),objs.forEach(function(a){return a.Draw()}),DrawHud()}};CreateAudioContext();nextState=GameState;window.addEventListener("keydown",function(a){"e"==a.key.toLowerCase()&&CreateEnemy()});